# 2 基礎概念
## 2.1 OSのコア：カーネル
OS(カーネル)・・CPU,RAM,デバイスなど、コンピュータの全リソースを管理するソフトウェアのこと。カーネルがなくてもプログラムは実行可能であるが、カーネルを利用他方がプログラムの開発と使用を大幅に簡略化できる

### カーネルが実行するタスク
- プロセススケジューリング
- メモリ管理
- ファイルシステム
- プロセスの作成と終了
- デバイスへのアクセス
- ネットワーク
- システムコール API（本書の主眼）

### kernel modeとuser mode
ユーザプロセスがカーネル内部のデータや命令にアクセスしシステムへ悪影響を与えるのを防ぐため、kernel modeからしか呼び出せない操作、メモリ空間が存在する

### プロセスから見たシステムとカーネルから見たシステム
> 日々行うプログラミングでは、頭の中ではプロセスの視点からプログラミングしていると思いま すが、本書で解説する内容を咀嚼するには視点を変え、カーネルの側からプログラムの動作を考え ることが非常に有効です

「プロセスは他のプロセスを作成できる」→「プロセスは他のプロセスを作成するようカーネルへ依頼できる」

## 2.2 シェル
シェル・・ユーザが入力したコマンドを読み取り、プログラムを実行する、特殊なプログラム(コマンドインタプリタ)。UNIXではシェルはユーザプロセスであるので、同一コンピュータでも異なるシェルが使用できる

## 2.3 ユーザとグループ
システム上のすべてのユーザは一意に識別され、少なくとも 1 つのグループに属す。
ユーザには一意なlogin nameと対応 するuser ID(UID)が与えられ、/etc/passwd 内 の 1 行がこれを定義

## 2.4 単一ディレクトリ階層、ディレクトリ、リンク、ファイル
### ファイルのオーナとパーミション
ファイルとディレクトリで意味がやや異なる。
ディレクトリに読み取り 許可・・そのディレクトリ直下のファイル名一覧を読み取れる
書き込み許可・・ 直下のファイル名を削除、変更、新規作成が可能
実行許可・・検索許可とも言 い、直下のファイルへのアクセスを許可

## 2.5 ファイル I/O モデル
UNIX システムの I/O モデルが持つ最大の特長は I/O の統一性。1 つのシ ステムコールが、デバイスも含め全種類のファイルに対する I/O を処理する。

### stdio ライブラリ
ファイル I/O を実行する場合、C 言語プログラムは標準 C ライブラリ内の I/O 関数(別名stdio ライブラリ)(fopen()、fclose()、scanf()、printf()、fgets()、fputs() など)を実行

## 2.6 プログラム
フィルタ・・データを stdin から読み取り、なんらかの変換を施し、結果を stdout へ書き込むプログラム。cat、grep、tr、sort、wc、sed、awk などが典型
コマンドラインパラメータ・・C 言語プログラムはコマンドラインパラメータへアクセスできる
```
int main(int argc, char *argv[])
//argc ・・コマンドラインパラメータの総数
//文字列配列 argv・・個々のパラメータ。先頭要素 argv[0] が指す文字列はプログラム自身の名前。
```

## 2.7 プロセス
### プロセスの終了と終了ステータス
シグナルにより強制終了させられた場合は、原因となったシグナル種類に応じ値が設定される
・０・・正常終了
・０以外・・異常終了

### プルセスのUIDとGID
プロセスは属性として複数種類のUID、GIDを持つ
・実UID,GID・・プロセスが属するユーザ、グループを表し、親プロセスから受け継ぐプロセス属性
・実効UID,GID・・保護されたリソースへアクセスする際のパー ミション検査に使用するID
・追加グループID・・上記以外のグループID

## 2.8 メモリマッピング

## 2.9 スタティックライブラリと共有ライブラリ

## 2.10 プロセス間通信と同期
シグナル・・なんらかのイベントが発生したことを通知する。
パイプ(シェルユーザには | としてお馴染み)および FIFO・・ プロセス間でデータを送受信する。
ソケット・・プロセス間でデータを送受信する。同一ホスト上のプロセス間でも、ネットワークを介した 他ホスト上のプロセスとも送受信可能。
ファイルロック・・指定した範囲のファイル内容の他プロセスによる読み取り、または書き込みを禁止する。
メッセージキュー・・プロセス間でメッセージ(データパケット)を交換する。
セマフォ・・複数プロセス間で実行の同期を図る。
共有メモリ・・複数のプロセスが特定のメモリ領域を共有する。プロセスが共有メモリの内容を変更すると、他のプロセスからその場で変更結果を参照できる。

## 2.11 シグナル
シェルからは kill コマンド、プログラム内からは kill() システムコールによりシグナルを送信できる。

## 2.12 スレッド
プロセスは内部に複数のスレッドを持てる

## 2.13 プロセスグループとジョブコントロール
```
$ ls -l | sort -k5n | less
```
3つのプロセスが作成されるが、パイプライン内の全てのプロセスは同じプロセスグループ(ジョブ)に属し、プロセスグループIDは全て同値となる。パイプライン内の全プロセスの実行を一時停止したりできるのは、この機能を用いてるから

## 2.14 セッション、制御端末、制御プロセス
・セッション・・ジョブの集合。sessionIDを持つ。セッションを作成したプロセスのPIDがSIDとなる

## 2.15 擬似端末

## .2.16 日付と時刻

## 2.17 クライアントサーバアーキテクチャ

## 2.18 リアルタイム性

## 2.19 /procファイルシステム
カーネル内のデータをファイルやディレクトリとして公開する擬似ファイルシステム。システムの動作や上限値などの変更、参照が容易になる。/proc/PIDでは実行中の全プロセスに関する情報を参照できる
